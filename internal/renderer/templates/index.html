<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>feedspool</title>
    <link rel="stylesheet" href="index.css">
    <script type="module" src="index.js"></script>
</head>
<body>
    <header>
        <h1>feedspool</h1>
        <details class="layout-options">
            <summary class="options-trigger">âš™ Options</summary>
            <div class="options-menu">
                <label class="option-item">
                    <input type="checkbox" id="show-thumbnails" checked>
                    Show thumbnails
                </label>
                <fieldset class="option-group">
                    <legend>View mode</legend>
                    <label class="option-item">
                        <input type="radio" name="view-mode" value="list" id="view-list" checked>
                        List
                    </label>
                    <label class="option-item">
                        <input type="radio" name="view-mode" value="card" id="view-card">
                        Card
                    </label>
                </fieldset>
            </div>
        </details>
    </header>

    <layout-controller>
        <main>
            <feed-navigator>
                {{if gt .TotalPages 1}}
                {{/* Paginated version: Load page fragments */}}
                {{range $pageNum := sequence 1 .TotalPages}}
                <link-loader>
                    <div class="page-loader-placeholder">
                        <p>Loading feeds {{add (mul (sub $pageNum 1) $.FeedsPerPage) 1}} - {{min (mul $pageNum $.FeedsPerPage) (len $.Feeds)}}...</p>
                    </div>
                    <a href="feeds/page-{{$pageNum}}.html#page-{{$pageNum}}">Load page {{$pageNum}}</a>
                </link-loader>
                {{end}}
                {{else}}
                {{/* Non-paginated version: Show all feeds directly */}}
                {{range .Feeds}}
                {{$items := index $.Items .URL}}
                {{if $items}}
                <link-loader>
                    <div class="feed-header">
                        <h2{{if .Description}} title="{{.Description}}"{{end}}>
                            {{$favicon := index $.FeedFavicon .URL}}
                            {{if $favicon}}<img src="{{$favicon}}" alt="" class="feed-favicon">{{end}}
                            {{.Title}}
                        </h2>
                        <time class="feed-last-updated">{{if .LatestItemDate.Valid}}Latest: {{.LatestItemDate.Time.Format "Jan 2, 2006 15:04 UTC"}}{{else}}Fetched: {{.LastSuccessfulFetch.Format "Jan 2, 2006 15:04 UTC"}}{{end}}</time>
                    </div>
                    <a href="feeds/{{.ID}}.html#feed-{{.ID}}">Read more...</a>
                </link-loader>
                {{end}}
                {{end}}
                {{end}}
            </feed-navigator>
        </main>
        <lightbox-overlay></lightbox-overlay>
    </layout-controller>

    <footer>
        <p>Generated by feedspool at {{.GeneratedAt.Format "2006-01-02 15:04:05 UTC"}}</p>
    </footer>
</body>
</html>